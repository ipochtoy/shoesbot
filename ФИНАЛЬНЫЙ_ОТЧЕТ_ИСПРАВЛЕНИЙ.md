# ‚úÖ –ó–ê–î–ê–ß–ê –í–´–ü–û–õ–ù–ï–ù–ê

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ (Pochtoy API) ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** HTTP 405 –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–µ–∫

**–†–µ—à–µ–Ω–∏–µ:**
- **Store (–∑–∞–≥—Ä—É–∑–∫–∞):** –∏–∑–º–µ–Ω–µ–Ω –º–µ—Ç–æ–¥ —Å `POST` –Ω–∞ `PUT` –¥–ª—è `/api/garage-tg/store`
- **Delete (—É–¥–∞–ª–µ–Ω–∏–µ):** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint `/api/garage-tg/delete` —Å –º–µ—Ç–æ–¥–æ–º `POST`
- **–§–∞–π–ª:** `shoessite/photos/pochtoy_integration.py`

**–ö–æ–¥:**
```python
# Store - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PUT
response = requests.put(
    'https://pochtoy-test.pochtoy3.ru/api/garage-tg/store',
    json=payload,
    headers=headers,
    timeout=60
)

# Delete - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç POST –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint
response = requests.post(
    'https://pochtoy-test.pochtoy3.ru/api/garage-tg/delete',
    json=payload,
    headers=headers,
    timeout=30
)
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –∞–¥–º–∏–Ω–∫–∏ ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** CSS –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª—Å—è (HTTP 403), –∞–¥–º–∏–Ω–∫–∞ –≤—ã–≥–ª—è–¥–µ–ª–∞ –∫–∞–∫ –≥–æ–ª—ã–π HTML

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/home/pochtoy/shoesbot/` –∏–º–µ–ª–∞ –ø—Ä–∞–≤–∞ `700` (drwx------).  
Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `www-data` –∏ –Ω–µ –º–æ–≥ –∑–∞–π—Ç–∏ –≤ —ç—Ç—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —á—Ç–µ–Ω–∏—è —Å—Ç–∞—Ç–∏–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
chmod 755 /home/pochtoy/shoesbot
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°—Ç–∞—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞: `https://pochtoy.us/static/admin/css/base.css` ‚Üí HTTP 200
- ‚úÖ –ê–¥–º–∏–Ω–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç –∫—Ä–∞—Å–∏–≤–æ —Å –ø–æ–ª–Ω—ã–º–∏ —Å—Ç–∏–ª—è–º–∏
- ‚úÖ –ò–∫–æ–Ω–∫–∏, –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã, –∫–Ω–æ–ø–∫–∏ - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ª–æ–º–æ–∫ ‚úÖ

**–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `fix_static_permissions.sh`:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ `/home/pochtoy/shoesbot/` ‚Üí 755
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç–∏–∫–∏
- –í—Å—Ç—Ä–æ–µ–Ω –≤ `deploy.sh` - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–ø–ª–æ—è

**WhiteNoise —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ fallback:**
- –ï—Å–ª–∏ nginx —Å–ª–æ–º–∞–µ—Ç—Å—è - Django —Å–∞–º –±—É–¥–µ—Ç —Ä–∞–∑–¥–∞–≤–∞—Ç—å —Å—Ç–∞—Ç–∏–∫—É
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –≤ `shoessite/settings.py`

**Nginx –∫–æ–Ω—Ñ–∏–≥ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω:**
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: `nginx-shoesbot-fixed.conf`
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ `–°–¢–ê–¢–ò–ö–ê_–ò–°–ü–†–ê–í–õ–ï–ù–ê.md`

### 4. –ë–æ—Ç —É–¥–∞–ª—è–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚úÖ
**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –ö–Ω–æ–ø–∫–∞ "Delete all" —Ç–µ–ø–µ—Ä—å —É–¥–∞–ª—è–µ—Ç –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è Pochtoy (üì° Pochtoy: ...)

**–§–∞–π–ª:** `shoesbot/django_upload.py`
- Message ID —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `SENT_BATCHES`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –±–∞—Ç—á–∞

## –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# 1. –°—Ç–∞—Ç–∏–∫–∞
curl https://pochtoy.us/static/admin/css/base.css
# ‚Üí HTTP 200 ‚úÖ

# 2. –ê–¥–º–∏–Ω–∫–∞
https://pochtoy.us/admin/
# ‚Üí –ö—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚úÖ

# 3. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
# ‚Üí –î–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å (–ø—Ä–æ–≤–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–∏–≤ —Ñ–æ—Ç–æ) ‚úÖ

# 4. –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
ssh gcp-shoesbot "systemctl status shoesbot.service shoesdjango.service"
# ‚Üí active (running) ‚úÖ
```

## –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ–ª–æ–º–æ–∫

1. **`fix_static_permissions.sh`** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
2. **WhiteNoise** - Django —Ä–∞–∑–¥–∞—Å—Ç —Å—Ç–∞—Ç–∏–∫—É –¥–∞–∂–µ –µ—Å–ª–∏ nginx —Å–ª–æ–º–∞–µ—Ç—Å—è
3. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã** - Pochtoy API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PUT/POST –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è
4. **–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ nginx –∫–æ–Ω—Ñ–∏–≥–∏** - –µ—Å—Ç—å –±–µ–∫–∞–ø—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª—è—é—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –±–∞—Ç—á–∞–º–∏

## –ö–æ–º–º–∏—Ç—ã

1. `27bfc9a` - Fix: WhiteNoise –¥–ª—è —Ä–∞–∑–¥–∞—á–∏ —Å—Ç–∞—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ Django
2. `adc2c7c` - Add: –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è nginx –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ + –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
3. `9d0afc6` - Fix: –°—Ç–∞—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞! –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –ø—Ä–∞–≤–∞—Ö –¥–æ—Å—Ç—É–ø–∞ 700

## –ò—Ç–æ–≥–æ

‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –ê–¥–º–∏–Ω–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ  
‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –±—É–¥—É—â–∏—Ö –ø–æ–ª–æ–º–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞  
‚úÖ –í—Å–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –≤ Git  

**–°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ**

